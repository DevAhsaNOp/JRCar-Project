@using PagedList.Mvc
@model  PagedList.IPagedList<JRCar.BOL.Validation_Classes.ValidationUserAds>



@foreach (var item in Model.Select((value, i) => new { i, value }))
{
    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
        <div class="auto-listing">
            <div class="cs-media ">
                <div id="my-pics_@item.i" class="carousel slide" data-ride="carousel"
                     style="margin:auto;">
                    <!-- Content -->
                    <div class="carousel-inner" role="listbox">
                        @if (item.value.CarImage != null)
                        {
                            string path = Server.MapPath("" + item.value.CarImage + "");
                            string[] FolderName = item.value.CarImage.Split('/');
                            string[] imageFiles = Directory.GetFiles(path);
                            List<string> images = new List<string>();
                            foreach (var jha in imageFiles)
                            {
                                images.Add(FolderName[2] + "/" + Path.GetFileName(jha));
                            }
                            var i = 1;
                            foreach (var AdImg in images)
                            {
                                if (i == 1)
                                {
                                    <div class="item active">
                                        <img src="~/uploads/@AdImg" alt="Ad Image" style="width: 100% !important; height: 200px !important;">
                                    </div>
                                }
                                else
                                {
                                    <div class="item">
                                        <img src="~/uploads/@AdImg" alt="Ad Image" style="width: 100% !important; height: 200px !important;">
                                    </div>
                                }
                                @*<figure>
                                        <img src="~/uploads/@AdImg" alt="Ad Image" style="height: 200px !important;" />
                                        <figcaption>
                                            <div class="cs-photo">@i / @images.Count Photos</div>
                                        </figcaption>
                                    </figure>*@
                                i++;
                            }
                        }
                    </div>
                    <!-- Previous/Next controls -->
                    <a class="left carousel-control" href="#my-pics_@item.i" role="button"
                       data-slide="prev">
                        <span class="icon-prev" aria-hidden="true"></span>
                        <span class="sr-only">Previous</span>
                    </a>
                    <a class="right carousel-control" href="#my-pics_@item.i" role="button"
                       data-slide="next">
                        <span class="icon-next" aria-hidden="true"></span>
                        <span class="sr-only">Next</span>
                    </a>
                </div>
            </div>
            <div class="auto-text">
                <div class="post-title">
                    <h4><a href="@Url.Action("CarDetail","Website",new { AdID = item.value.AdURL })">@item.value.Title</a></h4>
                    <h6><a href="@Url.Action("CarDetail","Website",new { AdID = item.value.AdURL })">@item.value.Title</a></h6>
                    <div class="auto-price" style="margin-bottom:10px !important"><span class="cs-color">PKR @string.Format("{0:n0}", Convert.ToDecimal(item.value.Price))</span></div>
                </div>
                <p style="font-weight:600 !important">Location: @item.value.City</p>
                <ul class="auto-info-detail">
                    <li>Year<span style="font-size: 14px !important;line-height: 26px !important">@item.value.Year</span></li>
                    <li>Model<span style="font-size: 14px !important;line-height: 26px !important">@item.value.Model</span></li>
                    <li>Condition<span style="font-size: 14px !important;line-height: 26px !important">@item.value.Condition</span></li>
                    @if (item.value.CreatedOn != null)
                    {
                        int years, weeks, months;
                        var Tdays = Convert.ToInt32((0 - (item.value.CreatedOn.Date - DateTime.Today.Date).TotalDays));
                        years = (Tdays / 365);
                        months = Convert.ToInt32((Tdays / 30.4368499));
                        weeks = (Tdays % 365) / 7;
                        Tdays = Tdays - ((years * 365) + (weeks * 7));
                        if (years > 0)
                        {
                            <li>
                                Posted On
                                <span style="font-size: 14px !important; line-height: 26px !important;text-transform: lowercase !important">
                                    @years @((years > 1) ? "years" : "year") ago
                                </span>
                            </li>
                        }
                        else if (months > 0)
                        {
                            <li>
                                Posted On
                                <span style="font-size: 14px !important;line-height: 26px !important;text-transform: lowercase !important">
                                    @months @((months > 1) ? "months" : "month") ago
                                </span>
                            </li>
                        }
                        else if (weeks > 0)
                        {
                            <li>
                                Posted On
                                <span style="font-size: 14px !important;line-height: 26px !important;text-transform: lowercase !important">
                                    @weeks @((weeks > 1) ? "weeks" : "week") ago
                                </span>
                            </li>
                        }
                        else
                        {
                            <li>
                                Posted On
                                <span style="font-size: 14px !important;line-height: 26px !important;text-transform: lowercase !important">
                                    @Tdays @((Tdays > 1) ? "days" : "day") ago
                                </span>
                            </li>
                        }
                    }
                </ul>
                <a href="#" class="short-list cs-color" style="margin-right: 14px !important;"><i class="icon-heart-o"></i>ShortList</a>
                <a href="@Url.Action("CarDetail","Website",new { AdID = item.value.AdURL })" class="View-btn" style="display:inline-block !important;">View Detail<i class=" icon-arrow-long-right"></i></a>
            </div>
        </div>
    </div>
}
<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
    <nav style=" text-align: center !important;">
        Page @(Model.PageCount < Model.PageNumber ? 0 : Model.PageNumber) of @Model.PageCount
        <div id="ContentPager">
            @Html.PagedListPager(Model, page => Url.Action("GetAds", "Website"), PagedListRenderOptions.ClassicPlusFirstAndLast)
        </div>
    </nav>
</div>
<div>
    Sort By::   @ViewBag.SortBy
</div>
<script>
    $(function () {
        $('[data-toggle="tooltip"]').tooltip()
    })

    // Initialize popover component
    $(function () {
        $('[data-toggle="popover"]').popover()
    })
</script>